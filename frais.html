<!DOCTYPE html>
  <html>
    <head>
      <!--Import Google Icon Font-->
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

      <!-- Icons -->
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

        <style>
.alert {
  padding: 20px;
  background-color: #f44336;
  color: white;
  opacity: 1;
  transition: opacity 0.6s;
  margin-bottom: 15px;
}

.alert.success {background-color: #04AA6D;}
.alert.info {background-color: #2196F3;}
.alert.warning {background-color: #ff9800;}

.closebtn {
  margin-left: 15px;
  color: white;
  font-weight: bold;
  float: right;
  font-size: 22px;
  line-height: 20px;
  cursor: pointer;
  transition: 0.3s;
}

.closebtn:hover {
  color: black;
}
</style>
    </head>

    <body onload="populateFields()">
      <div class="container">
        <form class="col s12">

            <!-- FRAIS FIXES -->
          <div class="row s12">
              <label><h4>Frais fixes</h4></label>
              <hr/>
            </div>
            <div class="row s12">
              <div class="input-field col s4">
                <i class="material-icons prefix">euro_symbol</i>
                <input id="LoyerAnnuel" type="number" class="validate">
                <label for="LoyerAnnuel">Loyer annuel</label>
              </div>
              <div class="input-field col s4">
                <i class="material-icons prefix">euro_symbol</i>
                <input id="UrsafAnnuel" type="number" class="validate">
                <label for="UrsafAnnuel">Estimation ursaf annuelle</label>
              </div>
              <div class="input-field col s4">
                <i class="material-icons prefix">euro_symbol</i>
                <input id="ElectriciteAnnuel" type="number" class="validate">
                <label for="ElectriciteAnnuel">Facture d'électricité annuelle</label>
              </div>
            </div>
            <div class="row s12">
              <div class="input-field col s4">
                  <i class="material-icons prefix">euro_symbol</i>
                  <input id="TransportsAnnuel" type="number" class="validate">
                  <label for="TransportsAnnuel">Facture de transports</label>
              </div>
              <div class="input-field col s4">
                <i class="material-icons prefix">euro_symbol</i>
                <input id="EauAnnuel" type="number" class="validate">
                <label for="EauAnnuel">Facture d'eau annuelle</label>
              </div>
              <div class="input-field col s4">
                <i class="material-icons prefix">euro_symbol</i>
                <input id="NettoyagesAnnuel" type="number" class="validate">
                <label for="NettoyagesAnnuel">Facture de nettoyages</label>
              </div>
            </div>
          


           <div class="row s12">
             <label><h5>Politique de distribution d'un éventuel excédent sous forme de bonus</h5></label>
              <div class="input-field col s12">
                <input id="CapBonusPourcentSalaire" type="number" min="0" max="100" class="validate">
                <label for="CapBonusPourcentSalaire">Pourcentage maximum du salaire que peut atteindre un bonus</label>
                <span class="helper-text" data-error="wrong" data-success="right">Saisissez un pourcentage entre 0 et 100</span>
              </div>
            </div>

            <div class="row s12">
              <label><h4>Collaborateurs</h4></label>
              <hr/>
            </div>
            <div class="row">
              <!-- COLLAB 1 --->
              <div class="col s3">
                  <div class="row">
                      <div class="input-field col s12">
                        <i class="material-icons prefix">person_add</i>
                        <input id="Collab01FullName" type="text" class="validate">
                        <label for="Collab01FullName">Nom complet</label>
                      </div>
                  </div>   
                  <div class="row">
                    <div class="input-field col s12">
                      <i class="material-icons prefix">email</i>
                      <input id="Collab01Email" type="email" class="validate">
                      <label for="Collab01Email">Email</label>
                      <span class="helper-text" data-error="wrong" data-success="right">Saisissez ici l'email du collaborateur</span>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <label>
                          <input id="Collab01Notif" type="checkbox" checked="false" />
                          <span>Green</span>
                      </label>   
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <input id="Collab01SalaireAnnuel" type="number" class="validate">
                      <label for="Collab01SalaireAnnuel">Salaire annuel</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                          <input id="Collab01BonusPercent" type="number" min="0" max="100" class="validate"> 
                          <label for="Collab01BonusPercent">Bonus en % du dépassement sur minimum bonus</label>
                          <span class="helper-text" data-error="wrong" data-success="right">Saisissez un pourcentage entre 0 et 100</span>
                    </div>
                  </div>
              </div>

              <!-- COLLAB 2 ---> 
              <div class="col s3">
                  <div class="row">
                      <div class="input-field col s6">
                        <i class="material-icons prefix">person_add</i>
                        <input id="Collab02FullName" type="text" class="validate">
                        <label for="Collab02FullName">Nom complet</label>
                      </div>
                  </div>   
                 <div class="row">
                    <div class="input-field col s12">
                      <i class="material-icons prefix">email</i>
                      <input id="Collab02Email" type="email" class="validate">
                      <label for="Collab02Email">Email</label>
                      <span class="helper-text" data-error="wrong" data-success="right">Saisissez ici l'email du collaborateur</span>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <label>
                          <input id="Collab02Notif" type="checkbox" checked="false" />
                          <span>Green</span>
                      </label>   
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s6">
                      <input id="Collab02SalaireAnnuel" type="number" class="validate">
                      <label for="Collab02SalaireAnnuel">Salaire annuel</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s6">
                          <input id="Collab02BonusPercent" type="number" min="0" max="100" class="validate" > 
                          <label for="Collab02BonusPercent">Bonus en % du dépassement sur minimum bonus</label>
                          <span class="helper-text" data-error="wrong" data-success="right">Saisissez un pourcentage entre 0 et 100</span>
                    </div>
                  </div>
              </div>

              <!-- COLLAB 3 --->
              <div class="col s3">
                  <div class="row">
                      <div class="input-field col s6">
                        <i class="material-icons prefix">person_add</i>
                        <input id="Collab03FullName" type="text" class="validate">
                        <label for="Collab03FullName">Nom complet</label>
                      </div>
                  </div>   
                 <div class="row">
                    <div class="input-field col s12">
                      <i class="material-icons prefix">email</i>
                      <input id="Collab03Email" type="email" class="validate">
                      <label for="Collab03Email">Email</label>
                      <span class="helper-text" data-error="wrong" data-success="right">Saisissez ici l'email du collaborateur</span>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <label>
                          <input id="Collab03Notif" type="checkbox" checked="false" />
                          <span>Green</span>
                      </label>   
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s6">
                      <input id="Collab03SalaireAnnuel" type="number" class="validate">
                      <label for="Collab03SalaireAnnuel">Salaire annuel</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s6">
                          <input id="Collab03BonusPercent" type="number" min="0" max="100" class="validate"> 
                          <label for="Collab03BonusPercent">Bonus en % du dépassement sur minimum bonus</label>
                          <span class="helper-text" data-error="wrong" data-success="right">Saisissez un pourcentage entre 0 et 100</span>
                    </div>
                  </div>
              </div>
              <!-- COLLAB 4 --->
              <div class="col s3">
                  <div class="row">
                      <div class="input-field col s6">
                        <i class="material-icons prefix">person_add</i>
                        <input id="Collab04FullName" type="text" class="validate">
                        <label for="Collab04FullName">Nom complet</label>
                      </div>
                  </div>   


                 <div class="row">
                    <div class="input-field col s12">
                      <i class="material-icons prefix">email</i>
                      <input id="Collab04Email" type="email" class="validate">
                      <label for="Collab04Email">Email</label>
                      <span class="helper-text" data-error="wrong" data-success="right">Saisissez ici l'email du collaborateur</span>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s12">
                      <label>
                          <input id="Collab04Notif" type="checkbox" checked="false" />
                          <span>Green</span>
                      </label>   
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s6">
                      <input id="Collab04SalaireAnnuel" type="number" class="validate">
                      <label for="Collab04SalaireAnnuel">Salaire annuel</label>
                    </div>
                  </div>
                  <div class="row">
                    <div class="input-field col s6">
                          <input id="Collab04BonusPercent" type="number" min="0" max="100" class="validate"> 
                          <label for="Collab04BonusPercent">Bonus en % du dépassement sur minimum bonus</label>
                          <span class="helper-text" data-error="wrong" data-success="right">Saisissez un pourcentage entre 0 et 100</span>
                    </div>
                  </div>
              </div>
            </div>

          <div class="alert warning" id="msgAlertWarning" hidden></div>
          <div class="row">
              <div class="input-field col s12">
                <button class="btn waves-effect waves-light" id="btnSubmitId" type="submit" name="action">Submit
                <i class="material-icons right">send</i>
                </button>
              </div>
            </div> 
            <!--
            <div id="notifications" class="toast" role="alert" >
              <div id="sauvegardeId" hidden>
                <div class="toast-header">
                  action en cours
                </div>
                <div class="toast-body">
                  Sauvegarde en cours, patience...
                </div>
              </div>
            </div> 
            -->  
        </form>
      </div>
          
      <!-- Compiled and minified JavaScript -->
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.96.1/js/materialize.min.js"></script>
      <script>
        
        window.closeDialog = function() 
        {
          google.script.host.close();
        }

        document.getElementById("btnSubmitId").addEventListener("click",addFraisRecord);
        document.getElementById("Collab01BonusPercent").addEventListener("input",testSumPercentages);
        document.getElementById("Collab02BonusPercent").addEventListener("input",testSumPercentages);
        document.getElementById("Collab03BonusPercent").addEventListener("input",testSumPercentages);
        document.getElementById("Collab04BonusPercent").addEventListener("input",testSumPercentages);
     
        function testSumPercentages()
        {
              
              let val1 = Number(document.getElementById("Collab01BonusPercent").value);
              let val2 = Number(document.getElementById("Collab02BonusPercent").value);
              let val3 = Number(document.getElementById("Collab03BonusPercent").value);
              let val4 = Number(document.getElementById("Collab04BonusPercent").value);

              if ( val1 + val2 + val3 + val4 +val5 > 100)
              {
                $("#msgAlertWarning").html("<h5>La somme des % dépasse 100% ! </h5>");
                document.getElementById("msgAlertWarning").style.display="block";
              }
              else
                document.getElementById("msgAlertWarning").style.display="none";
              return true;
        }

        
        function addFraisRecord()
        {
          var LoyerAnnuel = document.getElementById("LoyerAnnuel");
          var ElectriciteAnnuel = document.getElementById("ElectriciteAnnuel");
          var EauAnnuel = document.getElementById("EauAnnuel");
          var TransportsAnnuel = document.getElementById("TransportsAnnuel");
          var NettoyagesAnnuel = document.getElementById("NettoyagesAnnuel");
          var UrsafAnnuel           = document.getElementById("UrsafAnnuel");
          var CapBonusPourcentSalaire = document.getElementById("CapBonusPourcentSalaire");

          //Collab 1
          var Collab01FullName = document.getElementById("Collab01FullName");
          var Collab01SalaireAnnuel = document.getElementById("Collab01SalaireAnnuel");
          var Collab01BonusPercent = document.getElementById("Collab01BonusPercent");
          var Collab01Email = document.getElementById("Collab01Email");
          var Collab01Notif = document.getElementById("Collab01Notif");

          //Collab 2
          var Collab02FullName = document.getElementById("Collab02FullName");
          var Collab02SalaireAnnuel = document.getElementById("Collab02SalaireAnnuel");
          var Collab02BonusPercent = document.getElementById("Collab02BonusPercent");
          var Collab02Email = document.getElementById("Collab02Email");
          var Collab02Notif = document.getElementById("Collab02Notif");

          //Collab 3
          var Collab03FullName = document.getElementById("Collab03FullName");
          var Collab03SalaireAnnuel = document.getElementById("Collab03SalaireAnnuel");
          var Collab03BonusPercent = document.getElementById("Collab03BonusPercent");
          var Collab03Email = document.getElementById("Collab03Email");
          var Collab03Notif = document.getElementById("Collab03Notif");       

          //Collab 4
          var Collab04FullName = document.getElementById("Collab04FullName");
          var Collab04SalaireAnnuel = document.getElementById("Collab04SalaireAnnuel");
          var Collab04BonusPercent = document.getElementById("Collab04BonusPercent");
          var Collab04Email = document.getElementById("Collab04Email");
          var Collab04Notif = document.getElementById("Collab04Notif");   

      

          var data = {
            "dbTarget":"adminFrais",
            "LoyerAnnuel": LoyerAnnuel.value,
            "UrsafAnnuel" :     UrsafAnnuel.value,
            "ElectriciteAnnuel":ElectriciteAnnuel.value,
            "EauAnnuel":EauAnnuel.value,
            "TransportsAnnuel":TransportsAnnuel.value,
            "NettoyagesAnnuel": NettoyagesAnnuel.value,
            "CapBonusPourcentSalaire" : CapBonusPourcentSalaire.value,

            /** COLLAB */
            "Collab01FullName": Collab01FullName.value,
            "Collab01SalaireAnnuel": Collab01SalaireAnnuel.value,
            "Collab01BonusPercent": Collab01BonusPercent.value,
            "Collab01Email": Collab01Email.value,
            "Collab01Notif": Collab01Notif.checked,

            /** COLLAB */
            "Collab02FullName": Collab02FullName.value,
            "Collab02SalaireAnnuel": Collab02SalaireAnnuel.value,
            "Collab02BonusPercent": Collab02BonusPercent.value,
            "Collab02Email": Collab02Email.value,
            "Collab02Notif": Collab02Notif.checked,

            /** COLLAB */
            "Collab03FullName": Collab03FullName.value,
            "Collab03SalaireAnnuel": Collab03SalaireAnnuel.value,
            "Collab03BonusPercent": Collab03BonusPercent.value,
            "Collab03Email": Collab03Email.value,
            "Collab03Notif": Collab03Notif.checked,

            /** COLLAB */
            "Collab04FullName": Collab04FullName.value,
            "Collab04SalaireAnnuel": Collab04SalaireAnnuel.value,
            "Collab04BonusPercent": Collab04BonusPercent.value,
            "Collab04Email": Collab04Email.value,
            "Collab04Notif": Collab04Notif.checked,

            /** COLLAB : Soukcircus n'apparaît pas dans le formulaire*/
            "Collab05FullName": "Souk circus",
            "Collab05SalaireAnnuel": "0",
            "Collab05BonusPercent": "0",
            "Collab05Email": "soukcircus@gmail.com",
            "Collab05Notif": true
          };

          google.script.run.withSuccessHandler(closeDialog).updateFraisManager(data);

          return true;
        }
        

        
      function onFraisLoaded(fraisData) {
        document.getElementById('LoyerAnnuel').value = fraisData.LoyerAnnuel;
        document.getElementById('ElectriciteAnnuel').value = fraisData.ElectriciteAnnuel;
        document.getElementById('EauAnnuel').value = fraisData.EauAnnuel;
        document.getElementById('TransportsAnnuel').value = fraisData.TransportsAnnuel;
        document.getElementById('NettoyagesAnnuel').value = fraisData.NettoyagesAnnuel;
        document.getElementById('UrsafAnnuel').value = fraisData.UrsafAnnuel;
        document.getElementById('CapBonusPourcentSalaire').value = fraisData.CapBonusPourcentSalaire;

        /* == COLLAB */

        document.getElementById('Collab01FullName').value = fraisData.Collab01FullName;
        document.getElementById('Collab01SalaireAnnuel').value = fraisData.Collab01SalaireAnnuel;
        document.getElementById('Collab01BonusPercent').value = fraisData.Collab01BonusPercent;
        document.getElementById('Collab01Email').value = fraisData.Collab01Email;
        document.getElementById('Collab01Notif').checked = fraisData.Collab01Notif;

        /* == COLLAB */
        document.getElementById('Collab02FullName').value = fraisData.Collab02FullName;
        document.getElementById('Collab02SalaireAnnuel').value = fraisData.Collab02SalaireAnnuel;
        document.getElementById('Collab02BonusPercent').value = fraisData.Collab02BonusPercent;
        document.getElementById('Collab02Email').value = fraisData.Collab02Email;
        document.getElementById('Collab02Notif').checked = fraisData.Collab02Notif;

        /* == COLLAB  */
        document.getElementById('Collab03FullName').value = fraisData.Collab03FullName;
        document.getElementById('Collab03SalaireAnnuel').value = fraisData.Collab03SalaireAnnuel;
        document.getElementById('Collab03BonusPercent').value = fraisData.Collab03BonusPercent;
        document.getElementById('Collab03Email').value = fraisData.Collab03Email;
        document.getElementById('Collab03Notif').checked = fraisData.Collab03Notif;

        /* == COLLAB  */
        document.getElementById('Collab04FullName').value = fraisData.Collab04FullName;
        document.getElementById('Collab04SalaireAnnuel').value = fraisData.Collab04SalaireAnnuel;
        document.getElementById('Collab04BonusPercent').value = fraisData.Collab04BonusPercent;
        document.getElementById('Collab04Email').value = fraisData.Collab04Email;
        document.getElementById('Collab04Notif').checked = fraisData.Collab04Notif;

        /* == COLLAB  */
        /*
        document.getElementById('Collab05FullName').value = fraisData.Collab05FullName;
        document.getElementById('Collab05SalaireAnnuel').value = fraisData.Collab05SalaireAnnuel;
        document.getElementById('Collab05BonusPercent').value = fraisData.Collab05BonusPercent;
        document.getElementById('Collab05Email').value = fraisData.Collab05Email;
        document.getElementById('Collab05Notif').checked = fraisData.Collab05Notif;
        */
      }

    


      function populateFields()
      {
          google.script.run.withSuccessHandler(onFraisLoaded)
          .getFraisData();
          return true;
      }
      </script>


    </body>
  </html>
        